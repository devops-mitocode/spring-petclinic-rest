pipeline {
  agent none
  options { timestamps() }
  stages {

    stage('Build (Maven)') {
      agent {
        docker {
          image 'maven:3.9.9-eclipse-temurin-17-alpine'
          reuseNode true
        }
      }
      steps {
          sh "mvn -U -B -ntp clean packag"
      }
    }

    stage('AI Agent Analysis') {
      agent {
        docker {
          image 'ghcr.io/supportpal/github-gh-cli:2.87.3'
          reuseNode true
        }
      }
      steps {
        sh """
          gh --version

          gh auth status

          gh copilot explain 
        """
      }
    }
  }
}